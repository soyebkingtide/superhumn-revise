{%- comment %}BSS Login{% endcomment -%}{%- assign bss_locale =  request.locale.iso_code -%} {%- assign bss_translation = shop.metaobjects.app--2811029--bss_lock__metaobject.translation[bss_locale].value -%}{%- capture contentForQuerystring -%}{{ content_for_header }}{%- endcapture -%} {%- assign pageUrlWithHost = contentForQuerystring | split:'"pageurl":"' | last | split:'"' | first | replace:'\/','/' | replace:'%20',' ' | replace:'\u0026','&' -%} {% assign pageUrlWithHost =  "https://" | append: pageUrlWithHost  %} {% if bss-lock-fl-redirect-url %} {% unless bss-lock-fl-redirect-url contains 'https://' %} {% assign pageUrlWithHost = shop.url | append: bss-lock-fl-redirect-url %} {% else %} {% assign pageUrlWithHost = bss-lock-fl-redirect-url %} {% endunless %} {% endif %} {%- assign customer_data = customer -%} {%- assign theme_data = theme -%} {%- assign bss_list_auto_tag = '' -%} {% assign previous_bss_lock_scope = current_bss_lock_scope %} {% assign temp_variable_1 = lock_content_guest %} {% assign temp_variable_2 = lock_content_logged %} {% comment %} age form {% endcomment %} {% capture bss_lock_age_form %} {% include 'bss-lock-age-form', behavior_url: "https://login-api-v2.bsscommerce.com/behavior" %} {% endcapture %} {% comment %} capture content sntap form {% endcomment %} {% unless bss_lock_content_sntap %} {% for lock_id in bss_lock_ids %} {% unless bss_opened_lock_ids contains lock_id %} {% endunless %} {% endfor %} {% capture bss_lock_sntap_form %} {% if bss_lock_content_sntap != blank %} {{ bss_lock_content_sntap }} {% endif %} {% endcapture %} {% endunless %} {% comment %} capture content passcode form {% endcomment %} {% unless lock_content_passcode %} {% for lock_id in bss_lock_ids %} {% unless bss_opened_lock_ids contains lock_id %} {% endunless %} {% endfor %} {% capture bss_lock_passcode_form %} {% if lock_content_passcode != blank %} {{ lock_content_passcode }} {% endif %} {% endcapture %} {% endunless %} {% comment %} capture content passcode form {% endcomment %} {% unless bss_lock_content_register_form %} {% for lock_id in bss_lock_ids %} {% unless bss_opened_lock_ids contains lock_id %} {{ bss_lock_content_register_rules }} {% endunless %} {% endfor %} {% capture bss_lock_content_register_form %} {% if bss_lock_content_register_form != blank %} {{ bss_lock_content_register_form }} {% endif %} {% endcapture %} {% endunless %} {% comment %} capture content sl {% endcomment %} {% unless bss_lock_content_sl %} {% for lock_id in bss_lock_ids %} {% unless bss_opened_lock_ids contains lock_id %} {% endunless %} {% endfor %} {% endunless %} {% comment %} capture content guest {% endcomment %} {% unless lock_content_guest %} {% for lock_id in bss_lock_ids %} {% unless bss_opened_lock_ids contains lock_id %} {% if lock_id == '5333' %} {% unless lock_content_guest %} {% capture lock_content_guest %} {% capture bss_lock_check_content %} <p style="display: none" class="bss-fl-message"></p><p class="bss-fl-message" style="text-align: center;">Private content, please <a id="bss-fl-button-login" style="text-decoration-line: underline;" href="/account/login?checkout_url={{ pageUrlWithHost }}">login</a> to show or <a id="bss-fl-button-register" style="text-decoration-line: underline;" href="/account/register?checkout_url={{ pageUrlWithHost }}">create an account</a>.</p> {% endcapture %} {% if routes.account_login_url contains 'https://shopify.com' and bss_lock_check_content contains "{% render 'bss-lock-" %} <p class="bss-fl-message" style="text-align: center;">Private content, please <a id="bss-fl-button-login" style="text-decoration-line: underline;" href="{{ routes.account_login_url }}">login</a> to show or <a id="bss-fl-button-register" style="text-decoration-line: underline;" href="{{ routes.account_register_url }}">create an account</a>.</p> {% elsif bss_lock_check_content contains "Liquid error" %} <p class="bss-fl-message" style="text-align: center;">Private content, please <a id="bss-fl-button-login" style="text-decoration-line: underline;" href="{{ routes.account_login_url }}">login</a> to show or <a id="bss-fl-button-register" style="text-decoration-line: underline;" href="{{ routes.account_register_url }}">create an account</a>.</p> {% else %} {{ bss_lock_check_content }} {% endif %} {% endcapture %} {% endunless %} {% break %} {% endif %} {% endunless %} {% endfor %} {% capture bss_lock_guest_content %} {% if lock_content_guest != blank %} {{ lock_content_guest }} {% endif %} {% endcapture %} {% endunless %} {% comment %} capture lock contact support{% endcomment %} {% capture bss_lock_support_contact %} {% render 'bss-lock-support-contact' %} {% endcapture %} {% if bss_lock_support_contact contains 'Liquid error' %} {% assign bss_lock_support_contact = '' %} {% endif %} {% if bss_lock_access_denied_content == blank %} {% for lock_id in bss_lock_ids %} {% unless bss_opened_lock_ids contains lock_id %} {% if lock_id == '5333' %} {% unless lock_content_logged %} {% capture lock_content_logged %} <p style="text-align:center;" class="bss-access-denied-message">This content is locked, but it doesn’t look like you have access. If you feel this is a mistake, please contact the store owner.</p> {% endcapture %} {% endunless %} {% break %} {% endif %} {% endunless %} {% endfor %} {% if bss_lock_access_denied %} {% assign bss_lock_type = '' %} {% if bss_lock_requires_sl %} {% assign bss_lock_type = 'secret_link' %} {% elsif bss_lock_requires_passcode %} {% assign bss_lock_type = 'passcode' %} {% elsif bss_lock_requires_customer %} {% assign bss_lock_type = 'signed_in' %} {% elsif bss_lock_requires_age %} {% assign bss_lock_type = 'age_verification' %} {% elsif bss_lock_requires_sntap %} {% assign bss_lock_type = 'subscribe_email' %} {% elsif bss_lock_requires_customer_tag %} {% assign bss_lock_type = 'customer_tag' %} {% elsif bss_lock_invalid_ip %} {% assign bss_lock_type = 'specific_ip' %} {% else %} {% if lock_content_logged != blank %} {% assign bss_lock_type = condition_type %} {% else %} {% assign bss_lock_type = 'unknown' %} {% endif %} {% endif %} {% endif %} {% capture bss_lock_access_denied_content %} <style> .bss-lock-page-container { min-height: 40vh; padding-top: 48px; } </style> <div class="bss-lock-page-container"> {% if bss_lock_requires_sl %} {{ bss_lock_content_sl }} {% elsif bss_lock_requires_passcode %} {{ bss_lock_passcode_form }} {{ bss_lock_support_contact }} {% elsif bss_lock_requires_customer %} {{ bss_lock_guest_content }} {{ bss_lock_support_contact }} {% elsif customer_data %} {% if bss_lock_requires_age %} {{ bss_lock_age_form }} {% endif %} {% if bss_lock_requires_sntap %} {{ bss_lock_sntap_form }} {{ bss_lock_support_contact }} {% endif %} {% if lock_content_logged != blank %} {{ lock_content_logged }} {% else %} <div class="page-width"> <p class="bss-access-denied-message">This content is locked, but it doesn’t look like you have access. If you feel this is a mistake, please contact the store owner.</p> </div> {% endif %} {% elsif bss_lock_requires_age %} {{ bss_lock_age_form }} {% elsif bss_lock_requires_sntap %} {{ bss_lock_sntap_form }} {{ bss_lock_support_contact }} {% elsif bss_lock_requires_customer_tag %} {{ bss_lock_guest_content }} {% elsif condition_type == 'customer_specific' %} {{ bss_lock_guest_content }} {% elsif condition_type == 'customer_email' %} {{ bss_lock_guest_content }} {% elsif bss_lock_invalid_ip %} <div class="page-width"> <p class="bss-access-denied-message">This content is locked, but it doesn’t look like you have access. If you feel this is a mistake, please contact the store owner.</p> </div> {% else %} <div class="page-width"> {{ lock_content_logged }} </div> {% endif %} </div> {% endcapture %} {% endif %} {% comment %} gan lai gia tri để lần sau không render content {% endcomment %} {% assign current_bss_lock_scope = previous_bss_lock_scope %} {% assign lock_content_guest = temp_variable_1 %} {% assign lock_content_logged = temp_variable_2 %} {% include 'bss-lock-ip' %} {% comment %} check {% endcomment %}{%- comment %}BSS-Login{% endcomment -%}
